package main

import (
	    "flag"
	    "http"
		"fmt"
	    "log"
		"./cvis"
)

var addr = flag.String("addr", ":1718", "http service address") // Q=17, R=18

func main() {
	flag.Parse()
	http.Handle("/", http.HandlerFunc(QR))
	err := http.ListenAndServe(*addr, nil)
	if err != nil {
		log.Exit("ListenAndServe:", err)
	}
}

func QR(w http.ResponseWriter, req *http.Request) {
	b := cvis.Update([]byte{
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			0xFF,0x00,0x01,0x02,0x03, 0x04, 0x05,
			})
	//fmt.Fprintf(w, "HELLO THIS IS A TEST")
		b.String()
	fmt.Printf( b.String())
	fmt.Fprintf(w, b.String())
}


